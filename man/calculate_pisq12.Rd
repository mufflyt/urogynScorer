% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_pisq12.R
\name{calculate_pisq12}
\alias{calculate_pisq12}
\title{Calculate PISQ-12 (Pelvic Organ Prolapse/Urinary Incontinence Sexual Questionnaire) Scores}
\usage{
calculate_pisq12(
  questionnaire_data,
  id_column = NULL,
  item_prefix = "pisq_",
  reverse_items = c(1, 2, 3, 4),
  max_missing = 2,
  scale_to_100 = FALSE,
  verbose = FALSE
)
}
\arguments{
\item{questionnaire_data}{A data frame containing PISQ-12 item responses. Column
names should follow the pattern specified by the \code{item_prefix} parameter followed
by the item number (e.g., "pisq_1", "pisq_2", etc.).}

\item{id_column}{Character string specifying the column name containing patient
identifiers. If NULL (default), no ID column is used.}

\item{item_prefix}{A character string specifying the prefix for PISQ-12 column names.
Default is "pisq_".}

\item{reverse_items}{A numeric vector specifying which items should be reverse-scored.
Default is items 1, 2, 3, and 4, which are positively phrased items.}

\item{max_missing}{The maximum number of missing items allowed before score is set
to NA. Default is 2 (up to 2 missing items permitted).}

\item{scale_to_100}{Logical indicating whether to scale scores to a 0-100 range.
Default is FALSE (returns raw scores from 0-48).}

\item{verbose}{Logical indicating whether to display detailed logging information.
Default is FALSE.}
}
\value{
A data frame containing the original data plus additional columns:
\itemize{
\item \strong{pisq12_score}: The PISQ-12 score. If \code{scale_to_100 = TRUE},
scores range from 0-100, with higher scores indicating better sexual
function. Otherwise, scores range from 0-48.
\item \strong{pisq12_missing}: Count of missing items for each respondent.
\item \strong{pisq12_valid}: Logical indicating if the score is valid (TRUE if
missing items <= max_missing).
}
}
\description{
Calculates the Pelvic Organ Prolapse/Urinary Incontinence Sexual Questionnaire
(PISQ-12) score, which measures sexual function in women with pelvic floor
disorders. The function handles missing data, performs reverse scoring on appropriate
items, and validates inputs according to scoring guidelines.
}
\details{
The PISQ-12 consists of 12 items measuring sexual function across three domains:
behavioral/emotive (items 1-4), physical (items 5-9), and partner-related (items 10-12).
Each item is scored from 0 (always) to 4 (never).

Items 1-4 ask about positive aspects of sexual function and are reverse-scored so that
higher scores indicate better function. For all items, after any necessary reverse-scoring,
higher scores indicate better sexual function.

Missing data is handled by:
\enumerate{
\item Calculating the mean of answered items
\item Substituting this mean for missing values
\item Multiplying by 12/(12-n), where n is the number of missing items
\item If more than \code{max_missing} items are missing, the score is set to NA
}
}
\examples{
# Example 1: Basic usage with minimal data
pisq_data <- data.frame(
  patient_id = c("P001", "P002", "P003"),
  pisq_1 = c(3, 2, 1),  # Items 1-4 are positively phrased (reverse-scored)
  pisq_2 = c(4, 3, 2),
  pisq_3 = c(2, 3, 4),
  pisq_4 = c(3, 2, 1),
  pisq_5 = c(0, 1, 2),  # Items 5-12 are negatively phrased
  pisq_6 = c(1, 0, 3),
  pisq_7 = c(2, 1, 0),
  pisq_8 = c(1, 2, 1),
  pisq_9 = c(0, 1, 2),
  pisq_10 = c(1, 0, 3),
  pisq_11 = c(2, 1, 0),
  pisq_12 = c(1, 0, 1)
)

pisq12_results <- calculate_pisq12(
  questionnaire_data = pisq_data,
  id_column = "patient_id",
  scale_to_100 = FALSE,
  verbose = TRUE
)
print(pisq12_results)

# Example 2: With data containing missing values
pisq_data_missing <- data.frame(
  patient_id = c("P001", "P002", "P003"),
  pisq_1 = c(3, 2, NA),
  pisq_2 = c(4, 3, 2),
  pisq_3 = c(2, NA, 4),
  pisq_4 = c(3, 2, 1),
  pisq_5 = c(0, 1, 2),
  pisq_6 = c(1, 0, 3),
  pisq_7 = c(2, 1, NA),
  pisq_8 = c(1, 2, 1),
  pisq_9 = c(0, 1, 2),
  pisq_10 = c(1, NA, 3),
  pisq_11 = c(2, 1, 0),
  pisq_12 = c(1, 0, 1)
)

pisq12_results_missing <- calculate_pisq12(
  questionnaire_data = pisq_data_missing,
  id_column = "patient_id",
  max_missing = 2,
  scale_to_100 = TRUE,
  verbose = TRUE
)
print(pisq12_results_missing)

# Example 3: With alternative column naming convention
alt_pisq_data <- data.frame(
  record_id = c("R1", "R2", "R3"),
  pisq_item_1 = c(3, 2, 1),
  pisq_item_2 = c(4, 3, 2),
  pisq_item_3 = c(2, 3, 4),
  pisq_item_4 = c(3, 2, 1),
  pisq_item_5 = c(0, 1, 2),
  pisq_item_6 = c(1, 0, 3),
  pisq_item_7 = c(2, 1, 0),
  pisq_item_8 = c(1, 2, 1),
  pisq_item_9 = c(0, 1, 2),
  pisq_item_10 = c(1, 0, 3),
  pisq_item_11 = c(2, 1, 0),
  pisq_item_12 = c(1, 0, 1)
)

pisq12_results_alt <- calculate_pisq12(
  questionnaire_data = alt_pisq_data,
  id_column = "record_id",
  item_prefix = "pisq_item_",
  scale_to_100 = TRUE,
  verbose = TRUE
)
print(pisq12_results_alt)

}
\references{
Rogers RG, Coates KW, Kammerer-Doak D, Khalsa S, Qualls C (2003).
A short form of the Pelvic Organ Prolapse/Urinary Incontinence Sexual
Questionnaire (PISQ-12). \emph{International Urogynecology Journal and
Pelvic Floor Dysfunction, 14}(3), 164-168.
}
